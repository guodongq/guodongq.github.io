<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"guodongq.github.io","root":"/","images":"/images","scheme":"Mist","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="Golang provides a lot of open source frameworks for rest, such as beego, echo,iris and so on.In practice, when we use these frameworks, we will expose the unfriendly prompts such as exception inform">
<meta property="og:type" content="article">
<meta property="og:title" content="Integrate error codes for the go app!">
<meta property="og:url" content="https://guodongq.github.io/2019/05/27/golang/2019-05-27-errcode/index.html">
<meta property="og:site_name" content="小布之家">
<meta property="og:description" content="Golang provides a lot of open source frameworks for rest, such as beego, echo,iris and so on.In practice, when we use these frameworks, we will expose the unfriendly prompts such as exception inform">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-05-27T02:22:16.000Z">
<meta property="article:modified_time" content="2021-01-29T23:41:43.761Z">
<meta property="article:author" content="Bruce">
<meta property="article:tag" content="error_code">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://guodongq.github.io/2019/05/27/golang/2019-05-27-errcode/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>Integrate error codes for the go app! | 小布之家</title>
  



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">小布之家</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="nav-number">2.</span> <span class="nav-text">问题分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.</span> <span class="nav-text">项目介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="nav-number">4.</span> <span class="nav-text">使用说明</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E9%A1%B9%E7%9B%AE%E6%A8%A1%E5%9D%97"><span class="nav-number">4.1.</span> <span class="nav-text">导入项目模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89errcode%E6%96%87%E4%BB%B6"><span class="nav-number">4.2.</span> <span class="nav-text">定义errcode文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90"><span class="nav-number">4.3.</span> <span class="nav-text">项目集成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8E%E6%99%AE%E9%80%9A%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90"><span class="nav-number">4.3.1.</span> <span class="nav-text">与普通项目集成</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6"><span class="nav-number">4.3.1.1.</span> <span class="nav-text">初始化资源文件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E4%BB%A3%E7%A0%81%E8%B0%83%E7%94%A8"><span class="nav-number">4.3.2.</span> <span class="nav-text">业务代码调用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8Ebeego%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90"><span class="nav-number">4.3.3.</span> <span class="nav-text">与beego项目集成</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6-1"><span class="nav-number">4.3.3.1.</span> <span class="nav-text">初始化资源文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AF%AD%E8%A8%80"><span class="nav-number">4.3.3.2.</span> <span class="nav-text">初始化控制器语言</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E4%BB%A3%E7%A0%81%E8%B0%83%E7%94%A8-1"><span class="nav-number">4.3.3.3.</span> <span class="nav-text">业务代码调用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></div>
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bruce"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Bruce</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/qianguodong" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;qianguodong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:goldon.qian@gmail.com" title="E-Mail → mailto:goldon.qian@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://guodongq.github.io/2019/05/27/golang/2019-05-27-errcode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Bruce">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小布之家">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Integrate error codes for the go app!
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-05-27 10:22:16" itemprop="dateCreated datePublished" datetime="2019-05-27T10:22:16+08:00">2019-05-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-01-30 07:41:43" itemprop="dateModified" datetime="2021-01-30T07:41:43+08:00">2021-01-30</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <a id="more"></a>

<p>Golang provides a lot of open source frameworks for rest, such as <a target="_blank" rel="noopener" href="https://beego.me/">beego</a>, <a target="_blank" rel="noopener" href="http://go-echo.org/">echo</a>,<a target="_blank" rel="noopener" href="https://iris-go.com/">iris</a> and so on.<br>In practice, when we use these frameworks, we will expose the unfriendly prompts such as exception information and stacks directly to the user. In this case, it is necessary to integrate error codes for your golang application.</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><ul>
<li>Q：小明,不好了,你使用beego框架开发出来的微服务报错了<blockquote>
<p>啊，报的啥错呀？</p>
</blockquote>
</li>
<li>Q：界面上打印的是一串堆栈信息，看不懂<blockquote>
<p>我勒个去，可能是直接把堆栈抛出去了</p>
</blockquote>
</li>
<li>Q：中英文环境下结果还都是一样<blockquote>
<p>尼玛，没有区分不同环境了</p>
</blockquote>
</li>
<li>Q: 你难道没有在框架中引入错误码自定义异常信息吗? <blockquote>
<p>What ??? 什么是错误码 ???</p>
</blockquote>
</li>
</ul>
<h2 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h2><p>在微服务盛行的今日，单体应用可能会被拆分成多个微服务，微服务之间通过rest接口进行交互。<br>如何准确定义微服务之间的REST接口显得尤为重要，好的接口对于快速定位问题很有帮助。<br>针对前言中出现的问题，归根结底是REST接口定义的问题，错误码信息缺失。</p>
<h2 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h2><p>针对以上出现的错误，博主尝试编写了项目<a target="_blank" rel="noopener" href="https://github.com/qianguodong/go.errcode">go.errcode</a>,该项目可以提供多语言支持，用以提高用户的操作体验。</p>
<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="导入项目模块"><a href="#导入项目模块" class="headerlink" title="导入项目模块"></a>导入项目模块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &quot;github.com&#x2F;qianguodong&#x2F;go.errcode&quot;</span><br></pre></td></tr></table></figure>

<h3 id="定义errcode文件"><a href="#定义errcode文件" class="headerlink" title="定义errcode文件"></a>定义errcode文件</h3><p>假设你需要支持en-US和zh-CN两种语言，那么你就需要定义<code>errcode_en-US.json</code>和<code>errcode_zh-CN.json</code>   </p>
<ul>
<li><p>文件<code>errcode_en-US.json：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;errcodes&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;code&quot;: 10001,</span><br><span class="line">      &quot;message&quot;: &quot;not found&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;code&quot;: 10002,</span><br><span class="line">      &quot;message&quot;: &quot;hello, %s&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>文件 <code>errcode_zh-CN.json</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;errcodes&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;code&quot;: 10001,</span><br><span class="line">      &quot;message&quot;: &quot;无法找到&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;code&quot;: 10002,</span><br><span class="line">      &quot;message&quot;: &quot;你好, %s&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="项目集成"><a href="#项目集成" class="headerlink" title="项目集成"></a>项目集成</h3><h4 id="与普通项目集成"><a href="#与普通项目集成" class="headerlink" title="与普通项目集成"></a>与普通项目集成</h4><h5 id="初始化资源文件"><a href="#初始化资源文件" class="headerlink" title="初始化资源文件"></a>初始化资源文件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const (</span><br><span class="line">		zhCN &#x3D; &quot;zh-CN&quot;</span><br><span class="line">		enUS &#x3D; &quot;en-US&quot;</span><br><span class="line">	)</span><br><span class="line">	var supportLangs &#x3D; []string&#123;zhCN, enUS&#125;</span><br><span class="line">	&#x2F;&#x2F; init loading errcode</span><br><span class="line">	for _, lan :&#x3D; range supportLangs &#123;</span><br><span class="line">		filename :&#x3D; fmt.Sprintf(&quot;errcode_%s.json&quot;, lan)</span><br><span class="line">		if err :&#x3D; errcode.TryLoadErrCodeConfig(lan, filename); err !&#x3D; nil &#123;</span><br><span class="line">			panic(fmt.Sprintf(&quot;init errcode file%s failed, error %v&quot;, filename, err))</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="业务代码调用"><a href="#业务代码调用" class="headerlink" title="业务代码调用"></a>业务代码调用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var language &#x3D; zhCN</span><br><span class="line">message :&#x3D; errcode.GetErrMessage(language, 10002, &quot;world!&quot;)</span><br></pre></td></tr></table></figure>
<p>message将根据请求头里面的Accept-Language不同产生不同的结果：</p>
<ul>
<li>en-US： <code>hello, world!</code></li>
<li>zh-CN： <code>你好, world!</code></li>
</ul>
<h4 id="与beego项目集成"><a href="#与beego项目集成" class="headerlink" title="与beego项目集成"></a>与beego项目集成</h4><h5 id="初始化资源文件-1"><a href="#初始化资源文件-1" class="headerlink" title="初始化资源文件"></a>初始化资源文件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">func init()&#123;</span><br><span class="line">	lanTypes :&#x3D; strings.Split(beego.AppConfig.String(&quot;langs-define-in-app.conf&quot;), &quot;|&quot;)</span><br><span class="line">	for _, lan :&#x3D; range lanTypes&#123;</span><br><span class="line">		if err :&#x3D; errcode.TryLoadErrCodeConfig(lan, &quot;errcode_&quot;+lan+&quot;.json&quot;); err !&#x3D; nil&#123;</span><br><span class="line">			panic(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="初始化控制器语言"><a href="#初始化控制器语言" class="headerlink" title="初始化控制器语言"></a>初始化控制器语言</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">type BaseController struct&#123;</span><br><span class="line">	&#x2F;&#x2F; ...other fields</span><br><span class="line">	errcode.Locale</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func(b *BaseController) Prepare()&#123;</span><br><span class="line">	&#x2F;&#x2F; ... setter language by http header</span><br><span class="line">	b.Lan &#x3D; b.Ctx.Request.Header.Get(&quot;Accept-Language&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="业务代码调用-1"><a href="#业务代码调用-1" class="headerlink" title="业务代码调用"></a>业务代码调用</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">type BusinessController struct&#123;</span><br><span class="line">	BaseController</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func(b BusinessController)...()&#123;</span><br><span class="line">	...</span><br><span class="line">	message :&#x3D; b.GetErrMessage(10001)</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>message将根据请求头里面的Accept-Language产生不同的结果：</p>
<ul>
<li>en-US： <code>not found</code></li>
<li>zh-CN： <code>无法找到</code></li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>首先需要提供不同语言环境下的资源文件，并对资源文件进行初始化<ul>
<li>若使用类似beego这样的第三方框架，可定义<code>BaseController</code>匿名包含<code>errcode.Locale</code>,业务模块都继承自<code>BaseController</code></li>
</ul>
</li>
<li>调用获取错误码方法GetErrMessage，将语言，以及键传入，就可以得到国际化之后的错误信息</li>
<li>如果未找到相应键的对应值，则会输出键的原字符串</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/error-code/" rel="tag"># error_code</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/04/22/golang/2019-04-22-kubernetes-kubectl/" rel="prev" title="Kubectl!">
                  <i class="fa fa-chevron-left"></i> Kubectl!
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/05/30/golang/2019-05-30-testify/" rel="next" title="Testify!">
                  Testify! <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bruce</span>
</div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  

<script src="/js/local-search.js"></script>






  






<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.css">

<script>
NexT.utils.loadComments('#gitalk-container', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '566ec257445badffee98',
      clientSecret: 'd3f485d706e7ec94d5e4d9f5dfa989907f05b8c7',
      repo        : 'qianguodong.github.io',
      owner       : 'qianguodong',
      admin       : ['bruce'],
      id          : 'bbc73293eff9e1b8045f9ffd7c09ab5c',
        language: 'en',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
